<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Taguspark Flight Arena &mdash; Pegasus  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="License" href="../references/license.html" />
    <link rel="prev" title="System Identification" href="../vehicles/system_identification.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #000000" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setup/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/project_setup.html">Project Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/reference_frames.html">Standards</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features/autopilot/main.html">Autopilot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../console/terminal_console.html">Terminal console</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Simulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../simulation/gazebo_classic.html">Gazebo Classic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation/pegasus_simulator.html">Pegasus Simulator</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vehicles</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vehicles/vehicles.html">Vehicles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vehicles/system_identification.html">System Identification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Flight Arena</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Taguspark Flight Arena</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-optitrack-with-motive">Setting up Optitrack with Motive</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#shaky-rigid-body-asset">Shaky Rigid Body Asset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#marker-placement">Marker Placement</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #000000" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Pegasus</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Taguspark Flight Arena</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/source/arena/arena.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="taguspark-flight-arena">
<h1>Taguspark Flight Arena<a class="headerlink" href="#taguspark-flight-arena" title="Permalink to this heading"></a></h1>
<p>The Taguspark flight arena is an indoor space, under the administration of the ISR-Lisbon, which features an OptiTrack Motion Capture System (MCS).
The MCS consists of 8 cameras that are mounted on the ceiling of the arena and is used to track the position and orientation of rigid bodies equipped with reflective markers.
A dedicated computer streams the obtained data into a computer network.
The arena dimensions are 7.8 x 5.0 x 2.5 m.</p>
<a class="reference internal image-reference" href="../../_images/taguspark_arena.jpg"><img alt="Taguspark flight arena" class="align-center" src="../../_images/taguspark_arena.jpg" style="width: 600px;" /></a>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Arena Network Configurations</span><a class="headerlink" href="#id1" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Station SSID</p></td>
<td><p>Quadrotor</p></td>
</tr>
<tr class="row-even"><td><p>Station Password</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>IP Range</p></td>
<td><p>192.168.1.0/24</p></td>
</tr>
<tr class="row-even"><td><p>IPs reserved for vehicles</p></td>
<td><p>192.168.1.241 to 192.168.1.254</p></td>
</tr>
<tr class="row-odd"><td><p>Desktop IP</p></td>
<td><p>192.168.1.100</p></td>
</tr>
<tr class="row-even"><td><p>Free IP for laptop</p></td>
<td><p>192.168.1.240</p></td>
</tr>
</tbody>
</table>
<p>Here we describe the setup and calibration procedures for the OptiTrack MCS.</p>
<section id="setting-up-optitrack-with-motive">
<h2>Setting up Optitrack with Motive<a class="headerlink" href="#setting-up-optitrack-with-motive" title="Permalink to this heading"></a></h2>
<ol class="arabic" start="0">
<li><p>Turn on the OptiTrack cameras, the arena computer and router. Get also the calibration tools ready.</p></li>
<li><p>Launch the Motive application from the Windows desktop.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/01_Motive.jpg"><img alt="Motive application" class="align-center" src="../../_images/01_Motive.jpg" style="width: 600px;" /></a>
</div></blockquote>
</li>
</ol>
<ol class="arabic" start="2">
<li><p>Open the Camera Calibration pane <img alt="calibration_pane_icon" src="../../_images/02_calibration_pane_icon.png" /> and click on <code class="docutils literal notranslate"><span class="pre">Clear</span> <span class="pre">Mask</span></code> followed by <code class="docutils literal notranslate"><span class="pre">Mask</span> <span class="pre">Visible</span></code> to mask all the bright spots in the arena that can be mistakenly identified as passive markers.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/02_mask_visible.png"><img alt="Mask visible reflective regions" class="align-center" src="../../_images/02_mask_visible.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Start the calibration process by clicking on <code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">Wanding</span></code>.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/03_start_wanding.png"><img alt="Start wanding" class="align-center" src="../../_images/03_start_wanding.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Enter the arena with the <strong>calibration wand</strong> in hand and wave it around the arena. Make sure that the LED indicator ring of all cameras is completely filled in green.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/04_led_indicator_ring.jpg"><img alt="Led indicator ring" class="align-center" src="../../_images/04_led_indicator_ring.jpg" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Click on <code class="docutils literal notranslate"><span class="pre">Calculate</span></code> followed by <code class="docutils literal notranslate"><span class="pre">Apply</span></code> and wait for the <cite>Calibration Result Report</cite> window to pop up.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/05_calibration_done.png"><img alt="Performing the camera calibration" class="align-center" src="../../_images/05_calibration_done.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Check the <cite>Calibration Result Report</cite>. If it reports an <strong>Excellent</strong> or <strong>Exceptional</strong> calibration result, press <code class="docutils literal notranslate"><span class="pre">Apply</span></code>. Else, press <code class="docutils literal notranslate"><span class="pre">Cancel</span></code> and repeat the wanding process.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/06_calibration_result_report.png"><img alt="Calibration result report" class="align-center" src="../../_images/06_calibration_result_report.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Place the <strong>calibration square</strong> in the center of the arena, with the shorter leg pointing towards the windows.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/07_ground_plane_standard.jpg"><img alt="Ground plane standard" class="align-center" src="../../_images/07_ground_plane_standard.jpg" style="width: 600px;" /></a>
</div></blockquote>
</li>
</ol>
<div class="admonition- admonition">
<p class="admonition-title"></p>
<p>Have in mind that the motion data captured from the MCS is expressed in an East North Up (ENU) inertial frame, which is the standard in the ROS representation.
The <cite>mavlink interface</cite> converts this data to a North East Down (NED) inertial frame with the attitude following the Front Right Down (FRD) of the rigid body.</p>
</div>
<ol class="arabic" start="8">
<li><p>Open the <cite>Ground Plane</cite> tab of the Camera Calibration pane and click on <code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Ground</span> <span class="pre">Plane</span></code> to finish the calibration process.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/08_set_ground_plane.png"><img alt="Set the ground plane" class="align-center" src="../../_images/08_set_ground_plane.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
</ol>
<div class="admonition- admonition">
<p class="admonition-title"></p>
<p>You can save your calibration file for later use. It can be used during multiple consective days of experiments in the arena.
However, the calibration accuracy naturally deteriorates over time due to ambient factors, such as fluctuations in temperature.
<strong>You should re-calibrate the MCS on a weekly basis</strong>.</p>
</div>
<ol class="arabic" start="9">
<li><p>Take the calibration square out of the arena and place your vehicle inside the arena <strong>with its front pointing towards the windows</strong>. Select the group of markers you see on screen at once and check if all the markers placed on your vehicle are detected.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/09_selecting_the_vehicle.png"><img alt="Selecting the markers that will represent the vehicle" class="align-center" src="../../_images/09_selecting_the_vehicle.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
</ol>
<ol class="arabic" start="10">
<li><p>Create a rigid body from the selected markers by right-clicking over them and choosing the <code class="docutils literal notranslate"><span class="pre">Rigid</span> <span class="pre">Body</span></code> followed by <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">From</span> <span class="pre">Selected</span> <span class="pre">Markers</span></code>. On the Assets pane <img alt="assets_pane_icon" src="../../_images/10_assets_pane_icon.png" />, you should see the newly created rigid body.</p>
<a class="reference internal image-reference" href="../../_images/10_creating_the_rigid_body.png"><img alt="Creating the rigid body from the marker selection" class="align-center" src="../../_images/10_creating_the_rigid_body.png" style="width: 600px;" /></a>
</li>
</ol>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this heading"></a></h2>
<p>Here we provide some insight to solve some of the most frequent issues.
Please check the <a class="reference external" href="https://docs.optitrack.com/motive/rigid-body-tracking">Motive reference page</a> for more information on the calibration and troubleshooting procedures.</p>
<section id="shaky-rigid-body-asset">
<h3>Shaky Rigid Body Asset<a class="headerlink" href="#shaky-rigid-body-asset" title="Permalink to this heading"></a></h3>
<p>If by looking at an asset in the 3D viewport you notice that it is shaking when the Rigid body is stationary, you should then resort to the Rigid Body refinement tool to improve the accuracy of the Rigid Body calculations in Motive.
This tool allows Motive to collect additional samples, achieving more accurate tracking results by improving the calculation of expected marker locations of the Rigid Body as well as the position and orientation of the Rigid Body itself.</p>
<ol class="arabic">
<li><p>From the View menu, open the Builder pane, or click the <img alt="builder_pane_icon" src="../../_images/builder_pane_icon.png" /> button on the toolbar.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/open_builder_pane.png"><img alt="Open the Builder pane" class="align-center" src="../../_images/open_builder_pane.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Click the Edit tab.</p></li>
<li><p>Select the Rigid Body to be refined in the Assets pane.</p></li>
<li><p>Place the Rigid Body in the center of the arena so as many cameras as possible can clearly capture its markers.</p></li>
</ol>
<blockquote>
<div><blockquote>
<div><ol class="loweralpha simple">
<li><p>In the <strong>Refine</strong> section of the Edit tab of the Builder pane, click <em>Start…</em></p></li>
<li><p><strong>Slowly rotate</strong> the Rigid Body to collect samples at different orientations until the progress bar is full.</p></li>
</ol>
</div></blockquote>
<a class="reference internal image-reference" href="../../_images/builder_pane_refine.png"><img alt="Refine asset" class="align-center" src="../../_images/builder_pane_refine.png" style="width: 600px;" /></a>
</div></blockquote>
</section>
<section id="marker-placement">
<h3>Marker Placement<a class="headerlink" href="#marker-placement" title="Permalink to this heading"></a></h3>
<ul>
<li><p>Placing too many markers on one Rigid Body is not recommended.
When too many markers are placed in close vicinity, markers may overlap on the camera view, and Motive may not resolve individual reflections. This can increase the likelihood of label-swaps during capture.</p>
<div class="admonition- admonition">
<p class="admonition-title"></p>
<p>Whenever possible, though, it is best to use 4 or more markers to create a Rigid Body.
Additional markers provide more 3D coordinates for computing positions and orientations of a rigid body, making overall tracking more stable and less vulnerable to marker occlusions.</p>
</div>
</li>
<li><p>Placing the markers in symmetrical shapes such as squares, isosceles, or equilateral triangles make asset identification difficult and may cause the Rigid Body assets to flip during capture.
Within a Rigid Body asset, the markers should be placed asymmetrically because this provides a clear distinction of orientations.</p></li>
<li><p>Not having unique Rigid Bodies could lead to labeling errors especially when tracking several assets with similar size and shape.
When tracking multiple objects using passive markers, it is beneficial to create unique Rigid Body assets in Motive. Specifically, you need to place retroreflective markers in a distinctive arrangement between each object, which will allow Motive to more clearly identify the markers on each Rigid Body throughout capture.</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../vehicles/system_identification.html" class="btn btn-neutral float-left" title="System Identification" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../references/license.html" class="btn btn-neutral float-right" title="License" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Marcelo Jacinto.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>